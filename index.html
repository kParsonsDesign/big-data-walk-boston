<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="script.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>

  <body class="p-2">
    <h1>
      Big Data Handling
      <small class="text-muted"
        >Assignment from week 5 of MIT Full Stack Professional
        Certificate.</small
      >
    </h1>
    <p class="lead">
      Working with the Boston City data file for 22,000+ employees.
    </p>

    <h3 class="pt-3">Original Assignment Goals:</h3>
    <p>
      First, download the data from
      https://pollysnips.s3.amazonaws.com/bostonEmployeeSalaries.json using a
      curl request.
    </p>
    <p>Create a webpage that sorts through the data and displays:</p>
    <ol>
      <li>The top 5 earners in total income (salary + overtime) and list them out on the webpage as shown below:<br>
      Name&nbsp;&nbsp;&nbsp;&nbsp;Total Earned</li>
      <li>Find the total number of people who earn over $100,000 and display it on the webpage as shown below:<br>
      "The number of people working in Boston earning over $100,000 per year is ####."</li>
    </ol>

    <h3 class="pt-3">Original Assignment Results:</h3>
    <div id="topEarners" class="container">
      <div class="row gx-5"></div>
    </div>

    <!-- New Work -->
    <div id="fullTable"></div>

    <script src="./boston.js"></script>
    <script>
      const data = bostonData.data;
      const len = bostonData.data.length;

      function renderData(bostonData, topEarners) {
        data.sort((a, b) => a[18] - b[18]);
        data.reverse();
        //console.log(data);

        function checkEarnings(a) {
          return a[18] < 100000;
        }
        let lastBigEarner = data.findIndex(checkEarnings);
        //console.log(lastBigEarner);

        let html = '';
        for (let i = 0; i < 5; i++) {
          let earning = data[i][18];
          earning = earning.split('');
          earning.splice(3, 0, ',');
          earning = earning.join('');
          html +=
            '<tr class="data">' +
            '<td>' +
            data[i][8].replace(',', ', ') +
            '</td>' +
            '<td>$ ' +
            earning +
            '</td>' +
            '</tr>';
        }
        topEarners.innerHTML =
          '<div class="col-md"><p class="lead">Boston\'s Top 5 Earners:</p>' +
          '<table id="topEarners" class="table table-striped"><thead><tr><th>Name</th><th>Total Earned</th></tr></thead><tbody>' +
          html +
          '</tbody></table></div>';

        topEarners.innerHTML +=
          '<div class="col-md"><p class="lead">Total Big Earners</p>' +
          '<p>The number of people working in Boston earning over $100,000 is ' +
          lastBigEarner +
          '.</p></div>';
      }
      renderData(bostonData, document.getElementById('topEarners').firstElementChild);

      function renderTable(bostonData, fullTable) {}
      renderTable(bostonData, document.getElementById('fullTable'));
    </script>
  </body>
</html>
